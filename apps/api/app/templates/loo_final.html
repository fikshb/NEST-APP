<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Letter of Offer — Final | {{ company_name }}</title>
<style>
  @page { size: A4; margin: 2.5cm 2cm; }
  body { font-family: 'Helvetica Neue', Arial, sans-serif; color: #212929; line-height: 1.7; font-size: 11pt; }
  .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #133437; padding-bottom: 16px; margin-bottom: 24px; }
  .logo img { max-height: 60px; }
  .company-info { text-align: right; font-size: 9pt; color: #565656; }
  .doc-title { font-size: 16pt; font-weight: 600; color: #133437; margin-bottom: 4px; }
  .doc-ref { font-size: 9pt; color: #565656; margin-bottom: 24px; }
  .section { margin-bottom: 20px; }
  .section h3 { font-size: 11pt; font-weight: 600; color: #133437; border-bottom: 1px solid #dfdbd1; padding-bottom: 4px; margin-bottom: 10px; }
  table { width: 100%; border-collapse: collapse; margin-bottom: 12px; }
  table th, table td { text-align: left; padding: 6px 10px; border-bottom: 1px solid #e5e5e0; font-size: 10pt; }
  table th { background: #f7f7f5; color: #133437; font-weight: 600; width: 35%; }
  .price-highlight { background: #E8F5F0; }
  .price-highlight td { font-weight: 600; color: #133437; font-size: 11pt; }
  .terms ol { padding-left: 20px; }
  .terms li { margin-bottom: 6px; font-size: 10pt; }
  .acceptance { border: 1px solid #133437; padding: 20px; margin-top: 32px; }
  .acceptance h3 { margin-top: 0; border: none; padding: 0; }
  .acceptance-line { border-bottom: 1px solid #999; width: 100%; margin-top: 40px; margin-bottom: 4px; }
  .acceptance-label { font-size: 9pt; color: #565656; }
  .acceptance-grid { display: flex; justify-content: space-between; gap: 40px; margin-top: 24px; }
  .acceptance-col { flex: 1; }
  .validity { background: #FFF3CD; padding: 10px 16px; font-size: 9.5pt; font-weight: 600; color: #856404; margin-top: 20px; border-radius: 4px; text-align: center; }
  .signature-block { margin-top: 40px; page-break-inside: avoid; }
  .sig-img { max-height: 60px; margin-top: 12px; }
  .sig-line { width: 200px; padding-top: 4px; font-size: 10pt; }
  .acceptance { page-break-inside: avoid; }
  .section { page-break-inside: avoid; }
  table { page-break-inside: avoid; }
  .footer { margin-top: 48px; border-top: 1px solid #dfdbd1; padding-top: 10px; font-size: 8pt; color: #999; text-align: center; }
  .version-badge { display: inline-block; background: #133437; color: #fff; padding: 2px 10px; border-radius: 10px; font-size: 8pt; font-weight: 600; }
</style>
</head>
<body>

<div class="header">
  <div class="logo">
    {% if logo_data_uri %}<img src="{{ logo_data_uri }}" alt="Logo">{% endif %}
  </div>
  <div class="company-info">
    <strong>{{ company_name }}</strong><br>
    {{ company_address }}
  </div>
</div>

<div class="doc-title">Letter of Offer</div>
<div class="doc-ref">
  <span class="version-badge">Final v{{ version }}</span> &nbsp;|&nbsp;
  Ref: {{ deal.deal_code }} &nbsp;|&nbsp; Date: {{ generated_at }}
</div>

<p>Dear <strong>{{ tenant.full_name }}</strong>,</p>

<p>Further to our discussions, we are pleased to confirm the following offer for the rental of premises at {{ company_name }}. This Letter of Offer sets out the agreed terms between both parties.</p>

<div class="section">
  <h3>Tenant Information</h3>
  <table>
    <tr><th>Full Name</th><td>{{ tenant.full_name }}</td></tr>
    <tr><th>Email</th><td>{{ tenant.email }}</td></tr>
    <tr><th>Phone</th><td>{{ tenant.phone }}</td></tr>
    {% if tenant.company_name %}<tr><th>Company</th><td>{{ tenant.company_name }}</td></tr>{% endif %}
  </table>
</div>

<div class="section">
  <h3>Property Details</h3>
  <table>
    <tr><th>Unit</th><td>{{ unit.unit_code }} ({{ unit.unit_type }})</td></tr>
    <tr><th>Lease Term</th><td>{{ deal.term_type | replace("_", " ") | title }}</td></tr>
    <tr><th>Commencement Date</th><td>{{ deal.start_date }}</td></tr>
    {% if deal.end_date %}<tr><th>Expiry Date</th><td>{{ deal.end_date }}</td></tr>{% endif %}
  </table>
</div>

<div class="section">
  <h3>Agreed Rental</h3>
  <table>
    {% if effective_price != deal.initial_price %}
    <tr><th>Listed Rate</th><td style="text-decoration: line-through; color: #999;">{{ deal.currency }} {{ "{:,.2f}".format(deal.initial_price | float) }}</td></tr>
    {% endif %}
    <tr class="price-highlight"><th>Agreed Rate</th><td>{{ deal.currency }} {{ "{:,.2f}".format(effective_price | float) }}</td></tr>
  </table>
</div>

<div class="section terms">
  <h3>Terms and Conditions</h3>
  <ol>
    <li>The lease shall commence on {{ deal.start_date }}{% if deal.end_date %} and expire on {{ deal.end_date }}{% endif %}, unless extended by mutual written agreement.</li>
    <li>A security deposit equivalent to one (1) month's agreed rental ({{ deal.currency }} {{ "{:,.2f}".format(effective_price | float) }}) shall be payable upon execution of the Lease Agreement. The deposit is refundable at the end of the tenancy, subject to deductions for damages or outstanding charges.</li>
    <li>Rental payments shall be made in advance on or before the first day of each rental period via bank transfer to the designated account.</li>
    <li>The premises shall be used exclusively for residential purposes. Any change of use requires prior written consent from the Landlord.</li>
    <li>The Tenant shall maintain the premises in good and tenantable condition and shall be liable for any damage beyond normal wear and tear.</li>
    <li>Utility charges including electricity, water, and internet shall be borne by the Tenant. Service charges for common areas are included in the rental rate.</li>
    <li>Either party may terminate this agreement by providing no less than thirty (30) days' written notice prior to the intended date of termination.</li>
    <li>Upon acceptance of this offer, a formal Lease Agreement will be prepared for execution by both parties.</li>
  </ol>
</div>

<div class="validity">This offer is valid for seven (7) days from the date of issue. After this period, the offer shall be deemed withdrawn unless extended in writing.</div>

<div class="acceptance">
  <h3>Acceptance</h3>
  <p style="font-size: 10pt;">I, the undersigned, hereby accept the terms and conditions set out in this Letter of Offer and agree to proceed with the execution of a formal Lease Agreement.</p>

  <div class="acceptance-grid">
    <div class="acceptance-col">
      <div class="acceptance-line"></div>
      <div class="acceptance-label">Tenant Name &amp; Signature</div>
      <div class="acceptance-line" style="margin-top: 24px;"></div>
      <div class="acceptance-label">Date</div>
    </div>
    <div class="acceptance-col">
      <div class="acceptance-line"></div>
      <div class="acceptance-label">Witness Name &amp; Signature</div>
      <div class="acceptance-line" style="margin-top: 24px;"></div>
      <div class="acceptance-label">Date</div>
    </div>
  </div>
</div>

<div class="signature-block">
  <p>Issued by:</p>
  {% if signature_data_uri %}
  <img src="{{ signature_data_uri }}" alt="Signature" class="sig-img">
  {% endif %}
  {% if signatory_name %}
  <div class="sig-line">
    <strong>{{ signatory_name }}</strong><br>
    {{ signatory_title }}<br>
    {{ company_name }}
  </div>
  {% endif %}
</div>

<div class="footer">
  {{ company_name }} — Confidential | Ref: {{ deal.deal_code }} | v{{ version }} | {{ generated_at }}
</div>

</body>
</html>
